---
import ScrollReveal from '../UI/ScrollReveal.astro';
import { getLangFromUrl } from '../../i18n/utils.js';
import { translations } from '../../i18n/translations.js';

// Detect current language
const currentLang = getLangFromUrl(Astro.url);
const t = translations[currentLang];
---

<section class="descripcion">
  <div class="descripcion-container">
    <!-- Left column -->
    <div class="left-column">
      <ScrollReveal 
        text={t.descripcion.mainHeading}
        tag="h2"
        textClass="heading-highlight"
        baseOpacity={0.2}
        baseRotation={4}
        blurStrength={5}
        enableBlur={true}
      />
      
      <div class="content-text">
        <p>
          {t.descripcion.contentText}<br/>
          <strong class="text-highlight">{t.descripcion.contentHighlight}</strong> {t.descripcion.contentContinue}
        </p>
      </div>
    </div>
    
    <!-- Right column -->
    <div class="right-column">
      <div class="svg-wrapper">
        <img src="https://pub-d17bbbdbf8e348c5a57c8168ad69c92f.r2.dev/LightSVG.svg" alt="Light SVG" class="svg-element" />
        <div class="parallax-text-small" data-parallax-small>{t.descripcion.parallaxSmall}</div>
        <div class="parallax-text-large" data-parallax-large>{t.descripcion.parallaxLarge}</div>
      </div>
    </div>
  </div>
</section>

<style>
  .descripcion {
    background: var(--color-black-a);
    padding: 49px 50px;
    overflow: hidden;
  }

  .descripcion-container {
    max-width: 1392.94px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 50px;
  }

  /* Left column */
  .left-column {
    flex: 1;
    max-width: 50%;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: flex-start;
    gap: 50px;
    padding-top: 20px;
    padding-bottom: 20px;
  }

  :global(.heading-highlight) {
    width: 100%;
    max-width: 100%;
    color: var(--color-yellow) !important;
    font-size: var(--heading-5-size) !important;
    font-family: var(--font-heading) !important;
    font-weight: 300 !important;
    line-height: var(--heading-5-line-height) !important;
    word-wrap: break-word;
    overflow-wrap: break-word;
    hyphens: auto;
    margin: 0 !important;
  }

  :global(.heading-highlight .scroll-reveal-word) {
    color: var(--color-yellow) !important;
  }

  .content-text {
    align-self: stretch;
  }

  .content-text p {
    color: var(--color-white);
    font-size: var(--body-1-size);
    font-family: var(--font-body);
    font-weight: 400;
    word-wrap: break-word;
    overflow-wrap: break-word;
    hyphens: auto;
    margin: 0;
    line-height: 1.6;
    width: 100%;
    max-width: 100%;
  }

  .text-highlight {
    color: var(--color-yellow);
    font-weight: 700;
  }

  /* Right column */
  .right-column {
    flex: 1;
    max-width: 50%;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    align-items: flex-start;
    overflow: visible;
    position: relative;
  }

  .svg-wrapper {
    width: 100%;
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: flex-start;
    container-type: inline-size;
  }

  .svg-element {
    width: 100%;
    height: auto;
    object-fit: contain;
    object-position: left bottom;
    position: relative;
    z-index: 1;
  }

  .parallax-text-small {
    position: absolute;
    top: 4%;
    right: 15%;
    color: var(--color-black-a);
    font-family: var(--font-heading);
    font-size: clamp(12px, 4cqw, 24px);
    font-weight: 300;
    z-index: 3;
    pointer-events: none;
  }

  .parallax-text-large {
    position: absolute;
    bottom: 0%;
    left: 20%;
    color: var(--color-black-a);
    font-family: var(--font-heading);
    font-size: clamp(40px, 20cqw, 120px);
    font-weight: 600;
    z-index: 3;
    pointer-events: none;
  }

  /* Responsive adjustments */
  @media (max-width: 1400px) {
    .descripcion {
      padding: 40px 40px;
    }

    .descripcion-container {
      gap: 100px;
    }

  }

  @media (max-width: 1024px) {
    .descripcion-container {
      flex-direction: column;
      gap: 50px;
    }

    .left-column {
      width: 100%;
      max-width: 100%;
      padding-top: 0;
      padding-bottom: 0;
    }

    .right-column {
      max-width: 100%;
    }

    :global(.heading-highlight) {
      width: 100%;
    }

    .svg-wrapper {
      min-width: 100vw;
      /* min-height: 400px; */
    }

    .svg-element {
      width: 100%;
      height: 400px;
    }

    .parallax-text-small {
      font-size: clamp(10px, 3.5cqw, 20px);
      top: 6%;
      right: 50%;
    }

    .parallax-text-large {
      font-size: clamp(35px, 18cqw, 90px);
      bottom: 12%;
      left: 15%;
    }
  }

  @media (max-width: 991px) {
    .parallax-text-small {
      font-size: clamp(9px, 3.2cqw, 18px);
      top: 10%;
      right: 50%;
    }

    .parallax-text-large {
      font-size: clamp(32px, 16cqw, 80px);
      bottom: 14%;
      left: 20%;
    }
  }

  @media (max-width: 768px) {
    .descripcion {
      padding: 40px 30px;
    }

    .left-column {
      gap: 30px;
    }

    .heading-highlight {
      font-size: 24px;
      line-height: 28px;
    }

    .content-text p {
      font-size: 16px;
    }

    .svg-wrapper {
      min-width: 100vw;
      /* min-height: 350px; */
    }

    .svg-element {
      width: 100%;
      height: 350px;
    }

    .parallax-text-small {
      font-size: clamp(8px, 3cqw, 18px);
      top: 8%;
      right: 40%;
    }

    .parallax-text-large {
      font-size: clamp(30px, 15cqw, 70px);
      bottom: 15%;
      left: 25%;
    }
  }

  @media (max-width: 587px) {
    .parallax-text-small {
      font-size: clamp(7px, 2.8cqw, 16px);
      top: 12%;
      right: 20%;
    }

    .parallax-text-large {
      font-size: clamp(28px, 13cqw, 60px);
      bottom: 18%;
      left: 35%;
    }
  }

  @media (max-width: 480px) {
    .descripcion {
      padding: 30px 20px;
    }

    .left-column {
      gap: 20px;
    }

    .heading-highlight {
      font-size: 20px;
      line-height: 24px;
    }

    .content-text p {
      font-size: 14px;
    }

    .svg-wrapper {
      min-width: 100vw;
      /* min-height: 300px; */
    }

    .svg-element {
      width: 100%;
      height: 300px;
    }

    .parallax-text-small {
      font-size: clamp(6px, 2.5cqw, 16px);
      top: 10%;
      right: 20%;
    }

    .parallax-text-large {
      font-size: clamp(25px, 12cqw, 50px);
      bottom: 18%;
      left: 35%;
    }
  }

  @media (max-width: 375px) {
    .parallax-text-small {
      font-size: clamp(5px, 2.2cqw, 14px);
      top: 15%;
      right: 15%;
    }

    .parallax-text-large {
      font-size: clamp(22px, 10cqw, 45px);
      bottom: 20%;
      left: 40%;
    }
  }
</style>

<script>
  import { scroll, animate } from 'motion';

  document.addEventListener('DOMContentLoaded', () => {
    const smallText = document.querySelector('[data-parallax-small]') as HTMLElement;
    const largeText = document.querySelector('[data-parallax-large]') as HTMLElement;

    if (smallText) {
      scroll(
        animate(smallText, { y: [0, 40] }),
        {
          target: smallText,
          offset: ['start end', 'end start']
        }
      );
    }

    if (largeText) {
      scroll(
        animate(largeText, { y: [0, -60] }),
        {
          target: largeText,
          offset: ['start end', 'end start']
        }
      );
    }
  });
</script>
