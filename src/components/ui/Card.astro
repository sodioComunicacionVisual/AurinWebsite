---
import styles from './Card.module.css';

interface Props {
	letter: string;
	title: string;
	href?: string;
}

const { href, letter, title } = Astro.props;
const Tag = href ? 'a' : 'div';
const uniqueId = `card-${Math.random().toString(36).substr(2, 9)}`;
---

<Tag
	href={href}
	class={styles.card}
	data-card-id={uniqueId}
	target={href ? "_blank" : undefined}
	rel={href ? "noopener noreferrer" : undefined}
>
	<div class={styles['card-letter']} data-card-letter>
		{letter}
	</div>
	<div class={styles['card-content']} data-card-content>
		<div class={styles['card-title']} data-card-title>
			{title}
		</div>
	</div>
</Tag>

<script is:inline>
  (function() {
    function initCards() {
      const cards = document.querySelectorAll('[data-card-id]');

      const observerOptions = {
        threshold: 0.05,
        rootMargin: '100px 0px 0px 0px'
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add('is-visible');
            observer.unobserve(entry.target);
          }
        });
      }, observerOptions);

      cards.forEach((card, index) => {
        card.style.transitionDelay = `${index * 0.08}s`;
        observer.observe(card);
      });
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initCards);
    } else {
      initCards();
    }

    document.addEventListener('astro:page-load', initCards);
  })();
</script>


